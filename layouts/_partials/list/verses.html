{{/*
Template: section.html
Purpose: Default section layout for listing pages with pagination
Params:
- .Title: Section title
- .Content: Optional section description/content
- .Pages: Collection of pages to display
Usage: Automatically used for section pages (e.g., /articles/, /quran/)
Dependencies: Bootstrap 5.3, pagination.html partial
Rules:
- Displays 50 items per page with full content preview
- Limit the pages to within current surah
Exception: None
*/}}

<main class="container py-5" role="main">
  <header class="row border-bottom mb-4">
    <div class="col-12">
      <h1 class="py-2 mb-4 border-bottom border-5 border-primary">{{ .Title }}</h1>
      {{ if .Content }}
      <div class="lead mb-4">{{ .Content }}</div>
      {{ end }}
    </div>
  </header>

  <section aria-label="Quran verses listing">
    {{ $paginator := .Paginate .Pages 50 }}
    {{ $pages := $paginator.Pages }}
    {{ range $index, $page := $pages }}
    <div class="row">
      <div class="col-auto">
        {{ if and $page.Params.surah $page.Params.ayah }}
          <a href="{{ $page.RelPermalink }}" class="text-decoration-none fw-bold text-primary"
            aria-label="Go to Surah {{ $page.Params.surah }}, Ayah {{ $page.Params.ayah }}">
            {{ $page.Params.surah }}:{{ $page.Params.ayah }}
          </a>
        {{ else }}
          <a href="{{ $page.RelPermalink }}" class="text-decoration-none fw-bold text-primary">
            {{ $page.Title }}
          </a>
        {{ end }}
      </div>
      <div class="col">
        <div class="lh-lg">{{ $page.Plain }}</div>
        {{ if and $page.Params.surah $page.Params.ayah }}
          {{ $filePath := printf "notes/%d/%d.md" $page.Params.surah $page.Params.ayah }}
          {{ if fileExists $filePath}}
            <div class="m-2 p-2 ps-3 border-start border-5 border-info">
              {{ partial "includeFile.html" (dict "page" $filePath) }}
            </div>
          {{ end }}
        {{ end }}
      </div>
    </div>
    {{/* Display horizontal rule when surah changes between consecutive verses */}}
    {{ $nextIndex := add $index 1 }}
    {{ if lt $nextIndex (len $pages) }}
      {{ $nextPage := index $pages $nextIndex }}
      {{ if and $page.Params.surah $nextPage.Params.surah (ne $page.Params.surah $nextPage.Params.surah) }}
      <hr class="my-3 border-2 border-secondary opacity-50" />
      {{ end }}
    {{ end }}
    {{ end }}
  </section>

  {{ partial "pagination.html" $paginator }}
</main>